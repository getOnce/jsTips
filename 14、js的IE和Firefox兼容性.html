<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>14、js的IE和Firefox兼容性</title>
</head>
<body>
	<div class="pcs-article-content_ptkaiapt4bxy_baiduscarticle" id="detailArticleContent_ptkaiapt4bxy_baiduscarticle"><div><a href="http://www.cnblogs.com/tianyue3107/archive/2009/04/28/1445029.html" target="_blank">JS的IE和Firefox兼容性</a></div><div><p style="margin: 10px auto;">以下以&nbsp;IE&nbsp;代替&nbsp;Internet&nbsp;Explorer，以&nbsp;MF&nbsp;代替&nbsp;Mozzila&nbsp;Firefox&nbsp;<br>0、px的问题<br>obj.style.left&nbsp;=&nbsp;”100px”;<br>obj.style.top&nbsp;=&nbsp;”100px”;<br>千万要记得写上px，否则在Firefox上面两句无效！！</p><p style="margin: 10px auto;">1.&nbsp;document.form.item&nbsp;问题<br>(1)现有问题：<br>现有代码中存在许多&nbsp;document.formName.item(”itemName”)&nbsp;这样的语句，不能在&nbsp;MF&nbsp;下运行<br>(2)解决方法：<br>改用&nbsp;document.formName.elements[”elementName”]<br>(3)其它<br>参见&nbsp;2</p><p style="margin: 10px auto;">2.&nbsp;集合类对象问题<br>(1)现有问题：<br>现有代码中许多集合类对象取用时使用&nbsp;()，IE&nbsp;能接受，MF&nbsp;不能。<br>(2)解决方法：<br>改用&nbsp;[]&nbsp;作为下标运算。如：document.forms(”formName”)&nbsp;改为&nbsp;document.forms[”formName”]。<br>又如：document.getElementsByName(”inputName”)(1)&nbsp;改为&nbsp;document.getElementsByName(”inputName”)[1]<br>(3)其它</p><p style="margin: 10px auto;">3.&nbsp;window.event<br>(1)现有问题：<br>使用&nbsp;window.event&nbsp;无法在&nbsp;MF&nbsp;上运行<br>(2)解决方法：<br>MF&nbsp;的&nbsp;event&nbsp;只能在事件发生的现场使用，此问题暂无法解决。可以这样变通：<br>原代码(可在IE中运行)：<br>&lt;input&nbsp;type=”button”&nbsp;name=”someButton”&nbsp;value=”提交”&nbsp;onclick=”javascript:gotoSubmit()”/&gt;<br>…<br>&lt;script&nbsp;language=”javascript”&gt;<br>function&nbsp;gotoSubmit()&nbsp;{<br>…<br>alert(window.event);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;use&nbsp;window.event<br>…<br>}<br>&lt;/script&gt;<br>新代码(可在IE和MF中运行)：<br>&lt;input&nbsp;type=”button”&nbsp;name=”someButton”&nbsp;value=”提交”&nbsp;onclick=”javascript:gotoSubmit(event)”/&gt;<br>…<br>&lt;script&nbsp;language=”javascript”&gt;<br>function&nbsp;gotoSubmit(evt)&nbsp;{<br>evt&nbsp;=&nbsp;evt&nbsp;?&nbsp;evt&nbsp;:&nbsp;(window.event&nbsp;?&nbsp;window.event&nbsp;:&nbsp;null);<br>…<br>alert(evt);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;use&nbsp;evt<br>…<br>}<br>&lt;/script&gt;<br>此外，如果新代码中第一行不改，与老代码一样的话(即&nbsp;gotoSubmit&nbsp;调用没有给参数)，则仍然只能在IE中运行，但不会出错。所以，这种方案&nbsp;tpl&nbsp;部分仍与老代码兼容。</p><p style="margin: 10px auto;">4.&nbsp;HTML&nbsp;对象的&nbsp;id&nbsp;作为对象名的问题<br>(1)现有问题<br>在&nbsp;IE&nbsp;中，HTML&nbsp;对象的&nbsp;ID&nbsp;可以作为&nbsp;document&nbsp;的下属对象变量名直接使用。在&nbsp;MF&nbsp;中不能。<br>(2)解决方法<br>用&nbsp;getElementById(”idName”)&nbsp;代替&nbsp;idName&nbsp;作为对象变量使用。</p><p style="margin: 10px auto;">5.&nbsp;用idName字符串取得对象的问题<br>(1)现有问题<br>在IE中，利用&nbsp;eval(idName)&nbsp;可以取得&nbsp;id&nbsp;为&nbsp;idName&nbsp;的&nbsp;HTML&nbsp;对象，在MF&nbsp;中不能。<br>(2)解决方法<br>用&nbsp;getElementById(idName)&nbsp;代替&nbsp;eval(idName)。</p><p style="margin: 10px auto;">6.&nbsp;变量名与某&nbsp;HTML&nbsp;对象&nbsp;id&nbsp;相同的问题<br>(1)现有问题<br>在&nbsp;MF&nbsp;中，因为对象&nbsp;id&nbsp;不作为&nbsp;HTML&nbsp;对象的名称，所以可以使用与&nbsp;HTML&nbsp;对象&nbsp;id&nbsp;相同的变量名，IE&nbsp;中不能。<br>(2)解决方法<br>在声明变量时，一律加上&nbsp;var&nbsp;，以避免歧义，这样在&nbsp;IE&nbsp;中亦可正常运行。<br>此外，最好不要取与&nbsp;HTML&nbsp;对象&nbsp;id&nbsp;相同的变量名，以减少错误。<br>(3)其它<br>参见&nbsp;问题4</p><p style="margin: 10px auto;">7.&nbsp;event.x&nbsp;与&nbsp;event.y&nbsp;问题<br>鼠标当前坐标<br>IE：event.x和event.y。&nbsp;<br>FF：event.pageX和event.pageY。&nbsp;<br>通用：两者都有event.clientX和event.clientY属性。<br>(1)现有问题<br>在IE&nbsp;中，event&nbsp;对象有&nbsp;x,&nbsp;y&nbsp;属性，MF中没有。<br>(2)解决方法<br>在MF中，与event.x&nbsp;等效的是&nbsp;event.pageX。但event.pageX&nbsp;IE中没有。<br>故采用&nbsp;event.clientX&nbsp;代替&nbsp;event.x。在IE&nbsp;中也有这个变量。<br>event.clientX&nbsp;与&nbsp;event.pageX&nbsp;有微妙的差别（当整个页面有滚动条的时候），不过大多数时候是等效的。</p><p style="margin: 10px auto;">如果要完全一样，可以稍麻烦些：<br>mX&nbsp;=&nbsp;event.x&nbsp;?&nbsp;event.x&nbsp;:&nbsp;event.pageX;<br>然后用&nbsp;mX&nbsp;代替&nbsp;event.x<br>(3)其它<br>event.layerX&nbsp;在&nbsp;IE&nbsp;与&nbsp;MF&nbsp;中都有，具体意义有无差别尚未试验。</p><p style="margin: 10px auto;">8、鼠标当前坐标(加上滚动条滚过的距离)</p><p style="margin: 10px auto;">IE：event.offsetX和event.offsetY。&nbsp;<br>FF：event.layerX和event.layerY。</p><p style="margin: 10px auto;">9、标签的x和y的坐标位置：style.posLeft&nbsp;和&nbsp;style.posTop</p><p style="margin: 10px auto;">IE：有。&nbsp;<br>FF：没有。&nbsp;<br>通用：object.offsetLeft&nbsp;和&nbsp;object.offsetTop。</p><p style="margin: 10px auto;">10、窗体的高度和宽度</p><p style="margin: 10px auto;">IE：document.body.offsetWidth和document.body.offsetHeight。注意：此时页面一定要有body标签。&nbsp;<br>FF：window.innerWidth和window.innerHegiht，以及document.documentElement.clientWidth和document.documentElement.clientHeight。&nbsp;<br>通用：document.body.clientWidth和document.body.clientHeight。</p><p style="margin: 10px auto;">11、添加事件</p><p style="margin: 10px auto;">IE：element.attachEvent(”onclick”,&nbsp;func);。&nbsp;<br>FF：element.addEventListener(”click”,&nbsp;func,&nbsp;true)。&nbsp;<br>通用：element.onclick=func。虽然都可以使用onclick事件，但是onclick和上面两种方法的效果是不一样的，onclick只有执行一个过程，而attachEvent和addEventListener执行的是一个过程列表，也就是多个过程。例如：element.attachEvent(”onclick”,&nbsp;func1);element.attachEvent(”onclick”,&nbsp;func2)这样func1和func2都会被执行。</p><p style="margin: 10px auto;">12、标签的自定义属性</p><p style="margin: 10px auto;">IE：如果给标签div1定义了一个属性value，可以div1.value和div1[”value”]取得该值。&nbsp;<br>FF：不能用div1.value和div1[”value”]取。&nbsp;<br>通用：div1.getAttribute(”value”)。</p><p style="margin: 10px auto;">13、父节点、子节点和删除节点</p><p style="margin: 10px auto;">IE：parentElement、parement.children，element.romoveNode(true)。&nbsp;<br>FF：parentNode、parentNode.childNodes，node.parentNode.removeChild(node)。</p><p style="margin: 10px auto;">14、画图</p><p style="margin: 10px auto;">IE：VML。&nbsp;<br>FF：SVG。</p><p style="margin: 10px auto;">15、CSS：透明</p><p style="margin: 10px auto;">IE：filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=60)。&nbsp;<br>FF：opacity:0.6。</p><p style="margin: 10px auto;">16、CSS：圆角</p><p style="margin: 10px auto;">IE：不支持圆角。&nbsp;<br>FF：-moz-border-radius:4px，或者-moz-border-radius-topleft:4px;-moz-border-radius-topright:4px;-moz-border-radius-bottomleft:4px;-moz-border-radius-bottomright:4px;。</p><p style="margin: 10px auto;">17、CSS：双线凹凸边框</p><p style="margin: 10px auto;">IE：border:2px&nbsp;outset;。&nbsp;<br>FF：-moz-border-top-colors:&nbsp;#d4d0c8&nbsp;white;-moz-border-left-colors:&nbsp;#d4d0c8&nbsp;white;-moz-border-right-colors:#404040&nbsp;#808080;-moz-border-bottom-colors:#404040&nbsp;#808080;。</p><p style="margin: 10px auto;">18、关于frame<br>现有问题<br>在&nbsp;IE中&nbsp;可以用window.testFrame取得该frame，mf中不行<br>解决方法<br>在frame的使用方面MF和IE的最主要的区别是：<br>如果在frame标签中书写了以下属性：</p><p style="margin: 10px auto;">那么IE可以通过id或者name访问这个frame对应的window对象<br>而mf只可以通过name来访问这个frame对应的window对象<br>例如如果上述frame标签写在最上层的window里面的htm里面，那么可以这样访问<br>IE：&nbsp;window.top.frameId或者window.top.frameName来访问这个window对象<br>MF：只能这样window.top.frameName来访问这个window对象<br>另外，在mf和ie中都可以使用window.top.document.getElementById(”frameId”)来访问frame标签<br>并且可以通过window.top.document.getElementById(”testFrame”).src&nbsp;=&nbsp;’xx.htm’来切换frame的内容<br>也都可以通过window.top.frameName.location&nbsp;=&nbsp;’xx.htm’来切换frame的内容</p><p style="margin: 10px auto;">19、窗口<br>现有问题<br>IE中可以通过showModalDialog和showModelessDialog打开模态和非模态窗口，但是MF不支持。<br>解决办法<br>直接使用window.open(pageURL,name,parameters)方式打开新窗口。<br>如果需要传递参数，可以使用frame或者iframe。</p><p style="margin: 10px auto;">20、对高度的解析&nbsp;<br>IE：将根据内容的高度变化，包括未定义高度的图片内容，即使定义了高度，当内容超过高度时，将使用实际高度</p><p style="margin: 10px auto;">Firefox：没有定义高度时，如果内容中包括了图片内容，MF的高度解析是根据印刷标准，这样就会造成和实际内容高度不符合的情况；当定义了高度，但是内容超过高度时，内容会超出定义的高度，但是区域使用的样式不会变化，造成样式错位。</p><p style="margin: 10px auto;">结论：大家在可以确定内容高度的情况下最好定义高度，如果真的没有办法定义高度，最好不用使用边框样式，否则样式肯定会出现混乱！</p><p style="margin: 10px auto;">21、img对象alt和title的解析&nbsp;<br>alt：当照片不存在或者load错误时的提示；</p><p style="margin: 10px auto;">title：照片的tip说明。</p><p style="margin: 10px auto;">在IE中如果没有定义title，alt也可以作为img的tip使用，但是在MF中，两者完全按照标准中的定义使用</p><p style="margin: 10px auto;">结论：大家在定义img对象时，最后将alt和title对象都写全，保证在各种浏览器中都能正常使用</p><p style="margin: 10px auto;">22、其他的细节差别</p><p style="margin: 10px auto;">当你在写css的时候，特别是用float:&nbsp;left（或right）排列一窜图片时，会发现在firefox里面正常而IE里面有问题。无论你用margin:0,还是border:&nbsp;0来约束，都无济于事。</p><p style="margin: 10px auto;">其实这里还有另外一个问题，就是IE对于空格的处理，firefox是忽略的而IE对于块与块之间的空格是处理的。也就是说一个div结束后要紧接着一个div写，中间不要有回车或者空格。不然也许会有问题，比如3px的偏差，而且这个原因很难发现。</p><p style="margin: 10px auto;">非常不走运的是我又碰到了这样的问题，多个img标签连着，然后定义的float:&nbsp;left，希望这些图片可以连起来。但是结果在firefox里面正常而IE里面显示的每个img都相隔了3px。我把标签之间的空格都删除都没有作用。</p><p style="margin: 10px auto;">后来的解决方法是在img外面套li，并且对li定义margin:&nbsp;0，这样就解决了IE和firefox的显示偏差。IE对于一些模型的解释会产生很多错误问题，只有多多尝试才能发现原因。</p><p style="margin: 10px auto;">23、在连接事件处理函数的时候，可以用Inline&nbsp;HTML方式，也可以用Event<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property方式定义。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1、使用Inline&nbsp;HTML方式，如：<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=”radio”&nbsp;name=”radio”&nbsp;value=”1″<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onclick=”javascript:a(event)”&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注意：<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1)javascript不能省；<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(2)实参要使用event，形参使用什么都可以(如evt、event等)；<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2、使用Event&nbsp;property方式绑定事件处理函数，如：<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.form2.radio[0].onclick&nbsp;=&nbsp;a;<br>24、在mf中，自己定义的属性必须getAttribute()取得<br>25、在mf中没有&nbsp;&nbsp;&nbsp;parentElement&nbsp;parement.children&nbsp;&nbsp;&nbsp;而用<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parentNode&nbsp;parentNode.childNodes<br>&nbsp;&nbsp;&nbsp;&nbsp;childNodes的下标的含义在IE和MF中不同，MF使用DOM规范，childNodes中会插入空白<br>&nbsp;&nbsp;&nbsp;&nbsp;文本节点。<br>&nbsp;&nbsp;&nbsp;一般可以通过node.getElementsByTagName()来回避这个问题。<br>&nbsp;&nbsp;&nbsp;&nbsp;当html中节点缺失时，IE和MF对parentNode的解释不同，例如<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;MF中input.parentNode的值为form,&nbsp;而IE中input.parentNode的值为空节点</p><p style="margin: 10px auto;">&nbsp;&nbsp;&nbsp;&nbsp;MF中节点没有removeNode方法，必须使用如下方法<br>&nbsp;&nbsp;&nbsp;&nbsp;node.parentNode.removeChild(node)</p><p style="margin: 10px auto;">26、const&nbsp;问题<br>&nbsp;&nbsp;&nbsp;(1)现有问题:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在&nbsp;IE&nbsp;中不能使用&nbsp;const&nbsp;关键字。如&nbsp;const&nbsp;constVar&nbsp;=&nbsp;32;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在IE中这是语法错误。<br>&nbsp;&nbsp;&nbsp;(2)解决方法:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;不使用&nbsp;const&nbsp;，以&nbsp;var&nbsp;代替。<br>27、&nbsp;body&nbsp;对象<br>&nbsp;&nbsp;&nbsp;&nbsp;MF的body在body标签没有被浏览器完全读入之前就存在，而IE则必须在body完全被读入<br>&nbsp;&nbsp;&nbsp;&nbsp;之后才存在<br>28、url&nbsp;encoding<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在js中如果书写url就直接写&amp;不要写&amp;例如<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;’xx.jsp?objectName=xx&amp;objectEvent=xxx’;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.action&nbsp;=&nbsp;url那么很有可能url不会被正常显示以至于参数没有正确的传到服务器<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一般会服务器报错参数没有找到<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;当然如果是在tpl中例外，因为tpl中符合xml规范，要求&amp;书写为&amp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一般MF无法识别js中的&amp;<br>29、nodeName&nbsp;和&nbsp;tagName&nbsp;问题<br>&nbsp;&nbsp;&nbsp;(1)现有问题：<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在MF中，所有节点均有&nbsp;nodeName&nbsp;值，但&nbsp;textNode&nbsp;没有&nbsp;tagName&nbsp;值。在&nbsp;IE&nbsp;中，<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nodeName&nbsp;的使用好象<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;有问题（具体情况没有测试，但我的IE已经死了好几次）。<br>&nbsp;&nbsp;&nbsp;(2)解决方法：<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;使用&nbsp;tagName，但应检测其是否为空。</p></div><p><br></p></div>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>16、创建星星评级</title>
</head>
<body>
	

var btn = document.querySelector('.mGuideToAppBox'),
getA = btn.querySelector("a"),
 url = getA.getAttribute("data-url"),
 down = getA.getAttribute("data-download"),
 close = btn.querySelector(".close"),
 elapsed = 0;
var touchStartFunction = function(e){    

        start = new Date().getTime();

        // frame方式加载，防止跳转
        var iframe = document.createElement("iframe");
        iframe.src = url;
        iframe.style.display = "none";
        document.body.appendChild(iframe);

        end = new Date().getTime();
        elapsed = (end - start);
        if(elapsed < 20){
            window.location.href = down;
        }
        e.preventDefault();
        start = end = elapsed = null;
   
}
getA.removeEventListener('touchstart');
getA.addEventListener('touchstart', touchStartFunction, false);

close.addEventListener("click",function(e){
    e.stopPropagation();
    e.preventDefault();
    btn.style.display = "none";
    var date=new Date();
    date.setTime(date.getTime()+365*24*3600*1000); 
    document.cookie = "isShowAppBtn=true;expires="+date.toGMTString()+";path=/";
    return false;
},false);

var cookies = document.cookie.split(";"),
    l = cookies.length,
    i=0,
    k = true;
    for(;i<l;i++){
        if($.trim(cookies[i].split("=")[0])=="isShowAppBtn"){
            k = false;
            break;
        }
    }
    if(!k){
        btn.style.display = "none";
    }
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>17、环境检测</title>
</head>
<body>
	

/* 工具类 */
    var includes = function(str, sub){
        return str.indexOf(sub) !== -1;
    }
/* 功能实现 */
var UA = navigator.userAgent;
var userEnv;
var deviceType;
var deviceVersion;
// 判断设备类型
if (includes(UA, 'iPad') || includes(UA, 'iPhone') || includes(UA, 'iPod')) {
    deviceType = 'ios';

    // 匹配ios版本,ios 9以上支持Universal link
    // var matcher = UA.match('Version/([\\d\\.]+)');
    var matcher = UA.match(/(iPhone|iPod|iPad) os (\d)/i);
    if(matcher && matcher.length === 3){
        deviceVersion = matcher[2];
    }

} else if (includes(UA, 'Android')) {
    deviceType = 'android';

    // 匹配android版本号
    var matcher = UA.match('Android\\s([\\d\\.]+)');
    if(matcher && matcher.length === 2){
        deviceVersion = matcher[1];
    }

} else {
    deviceType = 'desktop';
}

// 判断设备环境(wechat, weibo)
if(includes(UA, 'MicroMessenger')){
    userEnv = 'wechat'
}else if(includes(UA, 'Weibo')){
    userEnv = 'weibo'
}
</body>
</html>